<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GovChain - Scheme Awareness Portal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d') no-repeat center center fixed;
      background-size: cover;
    }
    header {
      background-color: rgba(30, 41, 59, 0.9);
      color: white;
      padding: 1rem;
      text-align: center;
      backdrop-filter: blur(6px);
    }
    nav {
      display: flex;
      justify-content: center;
      background-color: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(6px);
    }
    nav button {
      background: none;
      border: none;
      color: white;
      padding: 1rem;
      cursor: pointer;
      font-size: 1rem;
    }
    nav button:hover {
      background-color: rgba(30, 41, 59, 0.9);
    }
    .tab-content {
      display: none;
      padding: 2rem;
      color: #111827;
    }
    .active {
      display: block;
    }
    input, textarea, button {
      display: block;
      margin: 1rem 0;
      padding: 0.5rem;
      width: 100%;
      max-width: 400px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #2563eb;
      color: white;
      border: none;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #1d4ed8;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: rgba(255, 255, 255, 0.9);
      padding: 2rem;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      margin-top: 1rem;
      border-radius: 12px;
      backdrop-filter: blur(4px);
    }
  </style>
</head>
<body>
  <header>
    <h1>GovChain - Scheme Awareness Portal</h1>
  </header>

  <nav>
    <button onclick="showTab('home')">Home</button>
    <button onclick="showTab('form')">Check Eligibility</button>
    <button onclick="showTab('schemes')">My Schemes</button>
    <button onclick="showTab('about')">About</button>
  </nav>

  <div class="container">
    <div id="home" class="tab-content active">
      <h2>Welcome</h2>
      <p>This platform uses AI & Blockchain to recommend suitable government welfare schemes based on your profile. All your data is securely processed and eligibility logs are stored transparently via blockchain.</p>
    </div>

    <div id="form" class="tab-content">
      <h2>Check Eligibility</h2>
      <input type="number" id="age" placeholder="Enter your age">
      <input type="number" id="income" placeholder="Enter your annual income">
      <input type="text" id="region" placeholder="Enter your region">
      <input type="text" id="education" placeholder="Enter your education level">
      <button onclick="checkEligibility()">Submit</button>
    </div>

    <div id="schemes" class="tab-content">
      <h2>Eligible Schemes</h2>
      <ul id="schemesList"></ul>
    </div>

    <div id="about" class="tab-content">
      <h2>About</h2>
      <p>GovChain is a decentralized AI & blockchain-based system that helps citizens discover welfare schemes they are eligible for. It ensures secure and transparent data processing for public trust and auditability.</p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
  <script>
    let contract;
    const contractAddress = '0xd8b934580fcE35a11B58C6D73aDeE468a2833fa8';
    const abi = [
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "user",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "age",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "income",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "string",
				"name": "region",
				"type": "string"
			},
			{
				"indexed": false,
				"internalType": "string",
				"name": "education",
				"type": "string"
			},
			{
				"indexed": false,
				"internalType": "string[]",
				"name": "schemes",
				"type": "string[]"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "timestamp",
				"type": "uint256"
			}
		],
		"name": "EligibilityStored",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_age",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_income",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_region",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_education",
				"type": "string"
			},
			{
				"internalType": "string[]",
				"name": "_schemes",
				"type": "string[]"
			}
		],
		"name": "storeEligibility",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "citizenData",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "age",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "income",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "region",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "education",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "timestamp",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getMyRecords",
		"outputs": [
			{
				"components": [
					{
						"internalType": "uint256",
						"name": "age",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "income",
						"type": "uint256"
					},
					{
						"internalType": "string",
						"name": "region",
						"type": "string"
					},
					{
						"internalType": "string",
						"name": "education",
						"type": "string"
					},
					{
						"internalType": "string[]",
						"name": "schemes",
						"type": "string[]"
					},
					{
						"internalType": "uint256",
						"name": "timestamp",
						"type": "uint256"
					}
				],
				"internalType": "struct GovChain.Citizen[]",
				"name": "",
				"type": "tuple[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "user",
				"type": "address"
			}
		],
		"name": "getUserRecords",
		"outputs": [
			{
				"components": [
					{
						"internalType": "uint256",
						"name": "age",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "income",
						"type": "uint256"
					},
					{
						"internalType": "string",
						"name": "region",
						"type": "string"
					},
					{
						"internalType": "string",
						"name": "education",
						"type": "string"
					},
					{
						"internalType": "string[]",
						"name": "schemes",
						"type": "string[]"
					},
					{
						"internalType": "uint256",
						"name": "timestamp",
						"type": "uint256"
					}
				],
				"internalType": "struct GovChain.Citizen[]",
				"name": "",
				"type": "tuple[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

    async function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');
    }

    async function checkEligibility() {
      const age = parseInt(document.getElementById('age').value);
      const income = parseInt(document.getElementById('income').value);
      const region = document.getElementById('region').value.toLowerCase();
      const education = document.getElementById('education').value.toLowerCase();

      const schemes = [];
      if (income < 200000 && region.includes('up')) schemes.push('PM Kisan Yojana');
      if (age > 60) schemes.push('Old Age Pension Scheme');
      if (education.includes('graduate')) schemes.push('Skill India Mission');

      const list = document.getElementById('schemesList');
      list.innerHTML = schemes.length ? schemes.map(s => `<li>${s}</li>`).join('') : '<li>No eligible schemes found.</li>';
      showTab('schemes');

      if (typeof window.ethereum !== 'undefined') {
        const web3 = new Web3(window.ethereum);
        await window.ethereum.enable();
        const accounts = await web3.eth.getAccounts();
        contract = new web3.eth.Contract(abi, contractAddress);

        try {
          await contract.methods.storeEligibility(age, income, region, education, schemes).send({ from: accounts[0] });
          console.log('Data stored on blockchain');
        } catch (err) {
          console.error('Blockchain transaction failed:', err);
        }
      } else {
        console.log('Please install MetaMask!');
      }
    }
  </script>
</body>
</html>
